@echo off
setlocal enabledelayedexpansion

:: –£–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Ç—å –∫ cwebp.exe (–µ—Å–ª–∏ –ª–µ–∂–∏—Ç –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ ‚Äî –Ω–µ —Ç—Ä–æ–≥–∞–µ–º)
set "WEBP=%~dp0cwebp.exe"

echo üîÅ –ù–∞—á–∏–Ω–∞–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ .webp...

:: –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ö–æ–¥–∏–º –≤—Å–µ .jpg, .jpeg, .png
for /R %%F in (*.jpg *.jpeg *.png) do (
    set "input=%%~fF"
    set "output=%%~dpnF.webp"
    
    :: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ .webp
    if not exist "!output!" (
        echo üî® –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è: %%~nxF
        "%WEBP%" "!input!" -q 75 -o "!output!"
    ) else (
        echo ‚è≠ –£–∂–µ –µ—Å—Ç—å .webp: %%~nxF ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
    )
)

echo ‚úÖ –ì–æ—Ç–æ–≤–æ! –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã.
pause
